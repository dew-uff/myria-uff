{"ftMode": "NONE", "plan": {"fragments": [{"operators": [{"argOperatorId": 1, "opType": "LocalMultiwayConsumer", "opName": "MyriaSplitConsumer", "opId": 0}, {"opName": "MyriaApply(L_ORDERKEY=$0,revenue=$3,O_ORDERDATE=$1,O_SHIPPRIORITY=$2)", "opType": "Apply", "argChild": 0, "emitExpressions": [{"outputName": "L_ORDERKEY", "rootExpressionOperator": {"type": "VARIABLE", "columnIdx": 0}}, {"outputName": "revenue", "rootExpressionOperator": {"type": "VARIABLE", "columnIdx": 3}}, {"outputName": "O_ORDERDATE", "rootExpressionOperator": {"type": "VARIABLE", "columnIdx": 1}}, {"outputName": "O_SHIPPRIORITY", "rootExpressionOperator": {"type": "VARIABLE", "columnIdx": 2}}], "opId": 2}, {"opType": "DbInsert", "opName": "MyriaStore(public:adhoc:q3)", "argOverwriteTable": true, "argChild": 2, "distributeFunction": {"indexes": [0, 2, 3], "type": "Hash"}, "relationKey": {"userName": "public", "relationName": "q3", "programName": "adhoc"}, "opId": 3}]}, {"operators": [{"argOperatorId": 5, "opType": "ShuffleConsumer", "opName": "MyriaShuffleConsumer", "opId": 4}, {"argGroupFields": [0, 1, 2], "opType": "Aggregate", "opName": "MyriaGroupBy($0,$1,$2; SUM($3))", "opId": 6, "argChild": 4, "aggregators": [{"type": "Primitive", "aggOps": ["SUM"], "column": 3}]}, {"opName": "MyriaSplitProducer", "opType": "LocalMultiwayProducer", "argChild": 6, "opId": 1}]}, {"operators": [{"argOperatorId": 8, "opType": "LocalMultiwayConsumer", "opName": "MyriaSplitConsumer", "opId": 7}, {"opName": "MyriaApply(O_ORDERDATE=$0,O_SHIPPRIORITY=$1,L_ORDERKEY=$2,_COLUMN3_=($3 * (1 - $4)))", "opType": "Apply", "argChild": 7, "emitExpressions": [{"outputName": "O_ORDERDATE", "rootExpressionOperator": {"type": "VARIABLE", "columnIdx": 0}}, {"outputName": "O_SHIPPRIORITY", "rootExpressionOperator": {"type": "VARIABLE", "columnIdx": 1}}, {"outputName": "L_ORDERKEY", "rootExpressionOperator": {"type": "VARIABLE", "columnIdx": 2}}, {"outputName": "_COLUMN3_", "rootExpressionOperator": {"right": {"right": {"type": "VARIABLE", "columnIdx": 4}, "left": {"valueType": "LONG_TYPE", "type": "CONSTANT", "value": "1"}, "type": "MINUS"}, "left": {"type": "VARIABLE", "columnIdx": 3}, "type": "TIMES"}}], "opId": 9}, {"argGroupFields": [2, 0, 1], "opType": "Aggregate", "opName": "MyriaGroupBy($2,$0,$1; SUM($3))", "opId": 10, "argChild": 9, "aggregators": [{"type": "Primitive", "aggOps": ["SUM"], "column": 3}]}, {"opName": "MyriaShuffleProducer(h($0,$1,$2))", "opType": "ShuffleProducer", "argChild": 10, "distributeFunction": {"indexes": [0, 1, 2], "type": "Hash"}, "opId": 5}]}, {"operators": [{"argOperatorId": 12, "opType": "ShuffleConsumer", "opName": "MyriaShuffleConsumer", "opId": 11}, {"argOperatorId": 14, "opType": "ShuffleConsumer", "opName": "MyriaShuffleConsumer", "opId": 13}, {"opType": "SymmetricHashJoin", "argSelect2": [0, 1, 2], "argSelect1": [1, 2], "argChild1": "13", "argChild2": "11", "opName": "MyriaSymmetricHashJoin(($3 = $0); $1,$2,$3,$4,$5)", "argColumnNames": ["O_ORDERDATE", "O_SHIPPRIORITY", "L_ORDERKEY", "L_EXTENDEDPRICE", "L_DISCOUNT"], "opId": 15, "argOrder": "ALTERNATE", "argColumns2": [0], "argColumns1": [0]}, {"opName": "MyriaSplitProducer", "opType": "LocalMultiwayProducer", "argChild": 15, "opId": 8}]}, {"operators": [{"argOperatorId": 17, "opType": "ShuffleConsumer", "opName": "MyriaShuffleConsumer", "opId": 16}, {"argOperatorId": 19, "opType": "ShuffleConsumer", "opName": "MyriaShuffleConsumer", "opId": 18}, {"opType": "SymmetricHashJoin", "argSelect2": [0, 4, 7], "argSelect1": [], "argChild1": "18", "argChild2": "16", "opName": "MyriaSymmetricHashJoin(($0 = $10); $9,$13,$16)", "argColumnNames": ["O_ORDERKEY", "O_ORDERDATE", "O_SHIPPRIORITY"], "opId": 20, "argOrder": "ALTERNATE", "argColumns2": [1], "argColumns1": [0]}, {"opName": "MyriaShuffleProducer(h($0))", "opType": "ShuffleProducer", "argChild": 20, "distributeFunction": {"indexes": [0], "type": "Hash"}, "opId": 14}]}, {"operators": [{"debroadcast": false, "opType": "TableScan", "opName": "MyriaScan(public:adhoc:LINEITEM)", "relationKey": {"userName": "public", "relationName": "LINEITEM", "programName": "adhoc"}, "opId": 21}, {"opName": "MyriaSelect(($10 > \":2\"))", "opType": "Filter", "argChild": 21, "argPredicate": {"rootExpressionOperator": {"right": {"valueType": "STRING_TYPE", "type": "CONSTANT", "value": ":2"}, "left": {"type": "VARIABLE", "columnIdx": 10}, "type": "GT"}}, "opId": 22}, {"opName": "MyriaApply(L_ORDERKEY=$0,L_EXTENDEDPRICE=$5,L_DISCOUNT=$6)", "opType": "Apply", "argChild": 22, "emitExpressions": [{"outputName": "L_ORDERKEY", "rootExpressionOperator": {"type": "VARIABLE", "columnIdx": 0}}, {"outputName": "L_EXTENDEDPRICE", "rootExpressionOperator": {"type": "VARIABLE", "columnIdx": 5}}, {"outputName": "L_DISCOUNT", "rootExpressionOperator": {"type": "VARIABLE", "columnIdx": 6}}], "opId": 23}, {"opName": "MyriaShuffleProducer(h($0))", "opType": "ShuffleProducer", "argChild": 23, "distributeFunction": {"indexes": [0], "type": "Hash"}, "opId": 12}]}, {"operators": [{"debroadcast": false, "opType": "TableScan", "opName": "MyriaScan(public:adhoc:CUSTOMER)", "relationKey": {"userName": "public", "relationName": "CUSTOMER", "programName": "adhoc"}, "opId": 24}, {"opName": "MyriaSelect(($6 = \":1\"))", "opType": "Filter", "argChild": 24, "argPredicate": {"rootExpressionOperator": {"right": {"valueType": "STRING_TYPE", "type": "CONSTANT", "value": ":1"}, "left": {"type": "VARIABLE", "columnIdx": 6}, "type": "EQ"}}, "opId": 25}, {"opName": "MyriaShuffleProducer(h($0))", "opType": "ShuffleProducer", "argChild": 25, "distributeFunction": {"indexes": [0], "type": "Hash"}, "opId": 19}]}, {"operators": [{"debroadcast": false, "opType": "TableScan", "opName": "MyriaScan(public:adhoc:ORDERS)", "relationKey": {"userName": "public", "relationName": "ORDERS", "programName": "adhoc"}, "opId": 26}, {"opName": "MyriaSelect(($4 < \":2\"))", "opType": "Filter", "argChild": 26, "argPredicate": {"rootExpressionOperator": {"right": {"valueType": "STRING_TYPE", "type": "CONSTANT", "value": ":2"}, "left": {"type": "VARIABLE", "columnIdx": 4}, "type": "LT"}}, "opId": 27}, {"opName": "MyriaShuffleProducer(h($1))", "opType": "ShuffleProducer", "argChild": 27, "distributeFunction": {"indexes": [1], "type": "Hash"}, "opId": 17}]}], "type": "SubQuery"}, "rawQuery": "lineitem = scan('LINEITEM');\ncustomer = scan('CUSTOMER');\norders = scan('ORDERS');\n-- $ID$\n-- TPC-H/TPC-R Shipping Priority Query (Q3)\n-- Functional Query Definition\n-- Approved February 1998\n\nq3 = select\n\tL_ORDERKEY,\n\tsum(L_EXTENDEDPRICE * (1 - L_DISCOUNT)) as revenue,\n\tO_ORDERDATE,\n\tO_SHIPPRIORITY\nfrom\n\tcustomer,\n\torders,\n\tlineitem\nwhere\n\tC_MKTSEGMENT = ':1'\n\tand C_CUSTKEY = O_CUSTKEY\n\tand L_ORDERKEY = O_ORDERKEY\n\tand O_ORDERDATE < ':2'\n\tand L_SHIPDATE > ':2';\n--group by         -- myrial doesn't need these\n--\tl_orderkey,\n--\to_orderdate,\n--\to_shippriority\n--TODO order by\n--TODO \trevenue desc,\n--TODO \to_orderdate;\n\nstore(q3, q3);", "profilingMode": [], "language": "myrial", "logicalRa": "Store(public:adhoc:q3)[Apply(L_ORDERKEY=$0,revenue=$3,O_ORDERDATE=$1,O_SHIPPRIORITY=$2)[GroupBy($2,$0,$1; SUM($3))[Apply(O_ORDERDATE=$0,O_SHIPPRIORITY=$1,L_ORDERKEY=$2,_COLUMN3_=($3 * (1 - $4)))[ProjectingJoin(($3 = $0); $1,$2,$3,$4,$5)[ProjectingJoin(($0 = $10); $9,$13,$16)[Select(($6 = \":1\"))[Scan(public:adhoc:CUSTOMER)],Select(($4 < \":2\"))[Scan(public:adhoc:ORDERS)]],Apply(L_ORDERKEY=$0,L_EXTENDEDPRICE=$5,L_DISCOUNT=$6)[Select(($10 > \":2\"))[Scan(public:adhoc:LINEITEM)]]]]]]]"}
