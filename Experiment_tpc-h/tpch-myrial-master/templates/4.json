{"ftMode": "NONE", "plan": {"fragments": [{"operators": [{"argOperatorId": 1, "opType": "LocalMultiwayConsumer", "opName": "MyriaSplitConsumer", "opId": 0}, {"opName": "MyriaApply(O_ORDERPRIORITY=$0,ORDER_COUNT=$1)", "opType": "Apply", "argChild": 0, "emitExpressions": [{"outputName": "O_ORDERPRIORITY", "rootExpressionOperator": {"type": "VARIABLE", "columnIdx": 0}}, {"outputName": "ORDER_COUNT", "rootExpressionOperator": {"type": "VARIABLE", "columnIdx": 1}}], "opId": 2}, {"opType": "DbInsert", "opName": "MyriaStore(public:adhoc:q4)", "argOverwriteTable": true, "argChild": 2, "distributeFunction": {"indexes": [0], "type": "Hash"}, "relationKey": {"userName": "public", "relationName": "q4", "programName": "adhoc"}, "opId": 3}]}, {"operators": [{"argOperatorId": 5, "opType": "ShuffleConsumer", "opName": "MyriaShuffleConsumer", "opId": 4}, {"argGroupFields": [0], "opType": "Aggregate", "opName": "MyriaGroupBy($0; SUM($1))", "opId": 6, "argChild": 4, "aggregators": [{"type": "Primitive", "aggOps": ["SUM"], "column": 1}]}, {"opName": "MyriaSplitProducer", "opType": "LocalMultiwayProducer", "argChild": 6, "opId": 1}]}, {"operators": [{"argOperatorId": 8, "opType": "LocalMultiwayConsumer", "opName": "MyriaSplitConsumer", "opId": 7}, {"argGroupFields": [0], "opType": "Aggregate", "opName": "MyriaGroupBy($0; COUNTALL)", "opId": 9, "argChild": 7, "aggregators": [{"type": "Primitive", "aggOps": ["COUNT"], "column": 0}]}, {"opName": "MyriaShuffleProducer(h($0))", "opType": "ShuffleProducer", "argChild": 9, "distributeFunction": {"indexes": [0], "type": "Hash"}, "opId": 5}]}, {"operators": [{"argOperatorId": 11, "opType": "ShuffleConsumer", "opName": "MyriaShuffleConsumer", "opId": 10}, {"argOperatorId": 13, "opType": "ShuffleConsumer", "opName": "MyriaShuffleConsumer", "opId": 12}, {"opType": "SymmetricHashJoin", "argSelect2": [], "argSelect1": [1], "argChild1": "12", "argChild2": "10", "opName": "MyriaSymmetricHashJoin(($2 = $0); $1)", "argColumnNames": ["O_ORDERPRIORITY"], "opId": 14, "argOrder": "ALTERNATE", "argColumns2": [0], "argColumns1": [0]}, {"opName": "MyriaSplitProducer", "opType": "LocalMultiwayProducer", "argChild": 14, "opId": 8}]}, {"operators": [{"debroadcast": false, "opType": "TableScan", "opName": "MyriaScan(public:adhoc:ORDERS)", "relationKey": {"userName": "public", "relationName": "ORDERS", "programName": "adhoc"}, "opId": 15}, {"opName": "MyriaSelect((($4 >= \":1\") and ($4 < \"1993-10-01\")))", "opType": "Filter", "argChild": 15, "argPredicate": {"rootExpressionOperator": {"right": {"right": {"valueType": "STRING_TYPE", "type": "CONSTANT", "value": "1993-10-01"}, "left": {"type": "VARIABLE", "columnIdx": 4}, "type": "LT"}, "left": {"right": {"valueType": "STRING_TYPE", "type": "CONSTANT", "value": ":1"}, "left": {"type": "VARIABLE", "columnIdx": 4}, "type": "GTEQ"}, "type": "AND"}}, "opId": 16}, {"opName": "MyriaApply(O_ORDERKEY=$0,O_ORDERPRIORITY=$5)", "opType": "Apply", "argChild": 16, "emitExpressions": [{"outputName": "O_ORDERKEY", "rootExpressionOperator": {"type": "VARIABLE", "columnIdx": 0}}, {"outputName": "O_ORDERPRIORITY", "rootExpressionOperator": {"type": "VARIABLE", "columnIdx": 5}}], "opId": 17}, {"opName": "MyriaShuffleProducer(h($0))", "opType": "ShuffleProducer", "argChild": 17, "distributeFunction": {"indexes": [0], "type": "Hash"}, "opId": 13}]}, {"operators": [{"argOperatorId": 19, "opType": "ShuffleConsumer", "opName": "MyriaShuffleConsumer", "opId": 18}, {"argGroupFields": [0], "opType": "Aggregate", "opName": "MyriaGroupBy($0; SUM($1))", "opId": 20, "argChild": 18, "aggregators": [{"type": "Primitive", "aggOps": ["SUM"], "column": 1}]}, {"opName": "MyriaSelect(($1 > 0))", "opType": "Filter", "argChild": 20, "argPredicate": {"rootExpressionOperator": {"right": {"valueType": "LONG_TYPE", "type": "CONSTANT", "value": "0"}, "left": {"type": "VARIABLE", "columnIdx": 1}, "type": "GT"}}, "opId": 21}, {"opName": "MyriaApply(e_key=$0)", "opType": "Apply", "argChild": 21, "emitExpressions": [{"outputName": "e_key", "rootExpressionOperator": {"type": "VARIABLE", "columnIdx": 0}}], "opId": 22}, {"opName": "MyriaShuffleProducer(h($0))", "opType": "ShuffleProducer", "argChild": 22, "distributeFunction": {"indexes": [0], "type": "Hash"}, "opId": 11}]}, {"operators": [{"argOperatorId": 24, "opType": "LocalMultiwayConsumer", "opName": "MyriaSplitConsumer", "opId": 23}, {"argGroupFields": [0], "opType": "Aggregate", "opName": "MyriaGroupBy($0; COUNTALL)", "opId": 25, "argChild": 23, "aggregators": [{"type": "Primitive", "aggOps": ["COUNT"], "column": 0}]}, {"opName": "MyriaShuffleProducer(h($0))", "opType": "ShuffleProducer", "argChild": 25, "distributeFunction": {"indexes": [0], "type": "Hash"}, "opId": 19}]}, {"operators": [{"argOperatorId": 27, "opType": "ShuffleConsumer", "opName": "MyriaShuffleConsumer", "opId": 26}, {"argOperatorId": 29, "opType": "ShuffleConsumer", "opName": "MyriaShuffleConsumer", "opId": 28}, {"opType": "SymmetricHashJoin", "argSelect2": [0], "argSelect1": [], "argChild1": "28", "argChild2": "26", "opName": "MyriaSymmetricHashJoin(($0 = $1); $1)", "argColumnNames": ["O_ORDERKEY"], "opId": 30, "argOrder": "ALTERNATE", "argColumns2": [0], "argColumns1": [0]}, {"opName": "MyriaSplitProducer", "opType": "LocalMultiwayProducer", "argChild": 30, "opId": 24}]}, {"operators": [{"debroadcast": false, "opType": "TableScan", "opName": "MyriaScan(public:adhoc:LINEITEM)", "relationKey": {"userName": "public", "relationName": "LINEITEM", "programName": "adhoc"}, "opId": 31}, {"opName": "MyriaSelect(($11 < $12))", "opType": "Filter", "argChild": 31, "argPredicate": {"rootExpressionOperator": {"right": {"type": "VARIABLE", "columnIdx": 12}, "left": {"type": "VARIABLE", "columnIdx": 11}, "type": "LT"}}, "opId": 32}, {"opName": "MyriaApply(L_ORDERKEY=$0)", "opType": "Apply", "argChild": 32, "emitExpressions": [{"outputName": "L_ORDERKEY", "rootExpressionOperator": {"type": "VARIABLE", "columnIdx": 0}}], "opId": 33}, {"opName": "MyriaShuffleProducer(h($0))", "opType": "ShuffleProducer", "argChild": 33, "distributeFunction": {"indexes": [0], "type": "Hash"}, "opId": 29}]}, {"operators": [{"debroadcast": false, "opType": "TableScan", "opName": "MyriaScan(public:adhoc:ORDERS)", "relationKey": {"userName": "public", "relationName": "ORDERS", "programName": "adhoc"}, "opId": 34}, {"opName": "MyriaApply(O_ORDERKEY=$0)", "opType": "Apply", "argChild": 34, "emitExpressions": [{"outputName": "O_ORDERKEY", "rootExpressionOperator": {"type": "VARIABLE", "columnIdx": 0}}], "opId": 35}, {"opName": "MyriaShuffleProducer(h($0))", "opType": "ShuffleProducer", "argChild": 35, "distributeFunction": {"indexes": [0], "type": "Hash"}, "opId": 27}]}], "type": "SubQuery"}, "rawQuery": "lineitem = scan('LINEITEM');\norders = scan('ORDERS');\n\n-- $ID$\n-- TPC-H/TPC-R Order Priority Checking Query (Q4)\n-- Functional Query Definition\n-- Approved February 1998\nexist = select\n    O_ORDERKEY as e_key,\n    COUNT(O_ORDERKEY) as e_count\n    from lineitem,\n         orders\n    where\n\t    L_ORDERKEY = O_ORDERKEY\n\t    and L_COMMITDATE < L_RECEIPTDATE;\n\nq4 = select\n    O_ORDERPRIORITY,\n\tcount(O_ORDERPRIORITY) as ORDER_COUNT\n    from\n        orders,\n        exist\n    where\n        e_key = O_ORDERKEY\n        and O_ORDERDATE >= ':1'\n        and O_ORDERDATE < '1993-10-01' -- ':1' + interval '3' month\n        and e_count > 0;\n\n--group by            -- not needed in myriaL\n--\to_orderpriority\n--order by\n--\to_orderpriority;\n\nstore(q4, q4);\n", "profilingMode": [], "language": "myrial", "logicalRa": "Store(public:adhoc:q4)[Apply(O_ORDERPRIORITY=$0,ORDER_COUNT=$1)[GroupBy($0; COUNT($0))[ProjectingJoin(($2 = $0); $1)[Apply(O_ORDERKEY=$0,O_ORDERPRIORITY=$5)[Select((($4 < \"1993-10-01\") and ($4 >= \":1\")))[Scan(public:adhoc:ORDERS)]],Apply(e_key=$0)[Select(($1 > 0))[GroupBy($0; COUNT($0))[ProjectingJoin(($0 = $1); $1)[Apply(L_ORDERKEY=$0)[Select(($11 < $12))[Scan(public:adhoc:LINEITEM)]],Apply(O_ORDERKEY=$0)[Scan(public:adhoc:ORDERS)]]]]]]]]]"}
