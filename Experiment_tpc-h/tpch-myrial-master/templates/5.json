{"ftMode": "NONE", "plan": {"fragments": [{"operators": [{"argOperatorId": 1, "opType": "LocalMultiwayConsumer", "opName": "MyriaSplitConsumer", "opId": 0}, {"opName": "MyriaApply(N_NAME=$0,revenue=$1)", "opType": "Apply", "argChild": 0, "emitExpressions": [{"outputName": "N_NAME", "rootExpressionOperator": {"type": "VARIABLE", "columnIdx": 0}}, {"outputName": "revenue", "rootExpressionOperator": {"type": "VARIABLE", "columnIdx": 1}}], "opId": 2}, {"opType": "DbInsert", "opName": "MyriaStore(public:adhoc:q5)", "argOverwriteTable": true, "argChild": 2, "distributeFunction": {"indexes": [0], "type": "Hash"}, "relationKey": {"userName": "public", "relationName": "q5", "programName": "adhoc"}, "opId": 3}]}, {"operators": [{"argOperatorId": 5, "opType": "ShuffleConsumer", "opName": "MyriaShuffleConsumer", "opId": 4}, {"argGroupFields": [0], "opType": "Aggregate", "opName": "MyriaGroupBy($0; SUM($1))", "opId": 6, "argChild": 4, "aggregators": [{"type": "Primitive", "aggOps": ["SUM"], "column": 1}]}, {"opName": "MyriaSplitProducer", "opType": "LocalMultiwayProducer", "argChild": 6, "opId": 1}]}, {"operators": [{"argOperatorId": 8, "opType": "LocalMultiwayConsumer", "opName": "MyriaSplitConsumer", "opId": 7}, {"opName": "MyriaApply(N_NAME=$2,_COLUMN1_=($0 * (1 - $1)))", "opType": "Apply", "argChild": 7, "emitExpressions": [{"outputName": "N_NAME", "rootExpressionOperator": {"type": "VARIABLE", "columnIdx": 2}}, {"outputName": "_COLUMN1_", "rootExpressionOperator": {"right": {"right": {"type": "VARIABLE", "columnIdx": 1}, "left": {"valueType": "LONG_TYPE", "type": "CONSTANT", "value": "1"}, "type": "MINUS"}, "left": {"type": "VARIABLE", "columnIdx": 0}, "type": "TIMES"}}], "opId": 9}, {"argGroupFields": [0], "opType": "Aggregate", "opName": "MyriaGroupBy($0; SUM($1))", "opId": 10, "argChild": 9, "aggregators": [{"type": "Primitive", "aggOps": ["SUM"], "column": 1}]}, {"opName": "MyriaShuffleProducer(h($0))", "opType": "ShuffleProducer", "argChild": 10, "distributeFunction": {"indexes": [0], "type": "Hash"}, "opId": 5}]}, {"operators": [{"argOperatorId": 12, "opType": "ShuffleConsumer", "opName": "MyriaShuffleConsumer", "opId": 11}, {"argOperatorId": 14, "opType": "ShuffleConsumer", "opName": "MyriaShuffleConsumer", "opId": 13}, {"opType": "SymmetricHashJoin", "argSelect2": [], "argSelect1": [0, 1, 2], "argChild1": "13", "argChild2": "11", "opName": "MyriaSymmetricHashJoin(($3 = $4); $0,$1,$2)", "argColumnNames": ["L_EXTENDEDPRICE", "L_DISCOUNT", "N_NAME"], "opId": 15, "argOrder": "ALTERNATE", "argColumns2": [0], "argColumns1": [3]}, {"opName": "MyriaSplitProducer", "opType": "LocalMultiwayProducer", "argChild": 15, "opId": 8}]}, {"operators": [{"argOperatorId": 17, "opType": "ShuffleConsumer", "opName": "MyriaShuffleConsumer", "opId": 16}, {"argOperatorId": 19, "opType": "ShuffleConsumer", "opName": "MyriaShuffleConsumer", "opId": 18}, {"opType": "SymmetricHashJoin", "argSelect2": [1, 2], "argSelect1": [24, 25], "argChild1": "18", "argChild2": "16", "opName": "MyriaSymmetricHashJoin(($39 = $44); $24,$25,$45,$46)", "argColumnNames": ["L_EXTENDEDPRICE", "L_DISCOUNT", "N_NAME", "N_REGIONKEY"], "opId": 20, "argOrder": "ALTERNATE", "argColumns2": [0], "argColumns1": [39]}, {"opName": "MyriaShuffleProducer(h($3))", "opType": "ShuffleProducer", "argChild": 20, "distributeFunction": {"indexes": [3], "type": "Hash"}, "opId": 14}]}, {"operators": [{"debroadcast": false, "opType": "TableScan", "opName": "MyriaScan(public:adhoc:REGION)", "relationKey": {"userName": "public", "relationName": "REGION", "programName": "adhoc"}, "opId": 21}, {"opName": "MyriaSelect(($1 = \":1\"))", "opType": "Filter", "argChild": 21, "argPredicate": {"rootExpressionOperator": {"right": {"valueType": "STRING_TYPE", "type": "CONSTANT", "value": ":1"}, "left": {"type": "VARIABLE", "columnIdx": 1}, "type": "EQ"}}, "opId": 22}, {"opName": "MyriaApply(R_REGIONKEY=$0)", "opType": "Apply", "argChild": 22, "emitExpressions": [{"outputName": "R_REGIONKEY", "rootExpressionOperator": {"type": "VARIABLE", "columnIdx": 0}}], "opId": 23}, {"opName": "MyriaShuffleProducer(h($0))", "opType": "ShuffleProducer", "argChild": 23, "distributeFunction": {"indexes": [0], "type": "Hash"}, "opId": 12}]}, {"operators": [{"argOperatorId": 25, "opType": "ShuffleConsumer", "opName": "MyriaShuffleConsumer", "opId": 24}, {"argOperatorId": 27, "opType": "ShuffleConsumer", "opName": "MyriaShuffleConsumer", "opId": 26}, {"opType": "SymmetricHashJoin", "argSelect2": [0, 1, 2, 3, 4, 5, 6, 7], "argSelect1": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35], "argChild1": "26", "argChild2": "24", "opName": "MyriaSymmetricHashJoin((($3 = $39) and ($21 = $36)); $0,$1,$2,$3,$4,$5,$6,$7,$8,$9,$10,$11,$12,$13,$14,$15,$16,$17,$18,$19,$20,$21,$22,$23,$24,$25,$26,$27,$28,$29,$30,$31,$32,$33,$34,$35,$36,$37,$38,$39,$40,$41,$42,$43)", "argColumnNames": ["C_CUSTKEY", "C_NAME", "C_ADDRESS", "C_NATIONKEY", "C_PHONE", "C_ACCTBAL", "C_MKTSEGMENT", "C_COMMENT", "C_RANDOM", "O_ORDERKEY", "O_CUSTKEY", "O_ORDERSTATUS", "O_TOTALPRICE", "O_ORDERDATE", "O_ORDERPRIORITY", "O_CLERK", "O_SHIPPRIORITY", "O_COMMENT", "O_RANDOM", "L_ORDERKEY", "L_PARTKEY", "L_SUPPKEY", "L_LINENUMBER", "L_QUANTITY", "L_EXTENDEDPRICE", "L_DISCOUNT", "L_TAX", "L_RETURNFLAG", "L_LINESTATUS", "L_SHIPDATE", "L_COMMITDATE", "L_RECEIPTDATE", "L_SHIPINSTRUCT", "L_SHIPMODE", "L_COMMENT", "L_RANDOM", "S_SUPPKEY", "S_NAME", "S_ADDRESS", "S_NATIONKEY", "S_PHONE", "S_ACCTBAL", "S_COMMENT", "S_RANDOM"], "opId": 28, "argOrder": "ALTERNATE", "argColumns2": [3, 0], "argColumns1": [3, 21]}, {"opName": "MyriaShuffleProducer(h($39))", "opType": "ShuffleProducer", "argChild": 28, "distributeFunction": {"indexes": [39], "type": "Hash"}, "opId": 19}]}, {"operators": [{"debroadcast": false, "opType": "TableScan", "opName": "MyriaScan(public:adhoc:NATION)", "relationKey": {"userName": "public", "relationName": "NATION", "programName": "adhoc"}, "opId": 29}, {"opName": "MyriaShuffleProducer(h($0))", "opType": "ShuffleProducer", "argChild": 29, "distributeFunction": {"indexes": [0], "type": "Hash"}, "opId": 17}]}, {"operators": [{"argOperatorId": 31, "opType": "ShuffleConsumer", "opName": "MyriaShuffleConsumer", "opId": 30}, {"argOperatorId": 33, "opType": "ShuffleConsumer", "opName": "MyriaShuffleConsumer", "opId": 32}, {"opType": "SymmetricHashJoin", "argSelect2": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16], "argSelect1": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18], "argChild1": "32", "argChild2": "30", "opName": "MyriaSymmetricHashJoin(($19 = $9); $0,$1,$2,$3,$4,$5,$6,$7,$8,$9,$10,$11,$12,$13,$14,$15,$16,$17,$18,$19,$20,$21,$22,$23,$24,$25,$26,$27,$28,$29,$30,$31,$32,$33,$34,$35)", "argColumnNames": ["C_CUSTKEY", "C_NAME", "C_ADDRESS", "C_NATIONKEY", "C_PHONE", "C_ACCTBAL", "C_MKTSEGMENT", "C_COMMENT", "C_RANDOM", "O_ORDERKEY", "O_CUSTKEY", "O_ORDERSTATUS", "O_TOTALPRICE", "O_ORDERDATE", "O_ORDERPRIORITY", "O_CLERK", "O_SHIPPRIORITY", "O_COMMENT", "O_RANDOM", "L_ORDERKEY", "L_PARTKEY", "L_SUPPKEY", "L_LINENUMBER", "L_QUANTITY", "L_EXTENDEDPRICE", "L_DISCOUNT", "L_TAX", "L_RETURNFLAG", "L_LINESTATUS", "L_SHIPDATE", "L_COMMITDATE", "L_RECEIPTDATE", "L_SHIPINSTRUCT", "L_SHIPMODE", "L_COMMENT", "L_RANDOM"], "opId": 34, "argOrder": "ALTERNATE", "argColumns2": [0], "argColumns1": [9]}, {"opName": "MyriaShuffleProducer(h($3,$21))", "opType": "ShuffleProducer", "argChild": 34, "distributeFunction": {"indexes": [3, 21], "type": "Hash"}, "opId": 27}]}, {"operators": [{"debroadcast": false, "opType": "TableScan", "opName": "MyriaScan(public:adhoc:SUPPLIER)", "relationKey": {"userName": "public", "relationName": "SUPPLIER", "programName": "adhoc"}, "opId": 35}, {"opName": "MyriaShuffleProducer(h($3,$0))", "opType": "ShuffleProducer", "argChild": 35, "distributeFunction": {"indexes": [3, 0], "type": "Hash"}, "opId": 25}]}, {"operators": [{"argOperatorId": 37, "opType": "ShuffleConsumer", "opName": "MyriaShuffleConsumer", "opId": 36}, {"argOperatorId": 39, "opType": "ShuffleConsumer", "opName": "MyriaShuffleConsumer", "opId": 38}, {"opType": "SymmetricHashJoin", "argSelect2": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9], "argSelect1": [0, 1, 2, 3, 4, 5, 6, 7, 8], "argChild1": "38", "argChild2": "36", "opName": "MyriaSymmetricHashJoin(($0 = $10); $0,$1,$2,$3,$4,$5,$6,$7,$8,$9,$10,$11,$12,$13,$14,$15,$16,$17,$18)", "argColumnNames": ["C_CUSTKEY", "C_NAME", "C_ADDRESS", "C_NATIONKEY", "C_PHONE", "C_ACCTBAL", "C_MKTSEGMENT", "C_COMMENT", "C_RANDOM", "O_ORDERKEY", "O_CUSTKEY", "O_ORDERSTATUS", "O_TOTALPRICE", "O_ORDERDATE", "O_ORDERPRIORITY", "O_CLERK", "O_SHIPPRIORITY", "O_COMMENT", "O_RANDOM"], "opId": 40, "argOrder": "ALTERNATE", "argColumns2": [1], "argColumns1": [0]}, {"opName": "MyriaShuffleProducer(h($9))", "opType": "ShuffleProducer", "argChild": 40, "distributeFunction": {"indexes": [9], "type": "Hash"}, "opId": 33}]}, {"operators": [{"debroadcast": false, "opType": "TableScan", "opName": "MyriaScan(public:adhoc:LINEITEM)", "relationKey": {"userName": "public", "relationName": "LINEITEM", "programName": "adhoc"}, "opId": 41}, {"opName": "MyriaShuffleProducer(h($0))", "opType": "ShuffleProducer", "argChild": 41, "distributeFunction": {"indexes": [0], "type": "Hash"}, "opId": 31}]}, {"operators": [{"debroadcast": false, "opType": "TableScan", "opName": "MyriaScan(public:adhoc:CUSTOMER)", "relationKey": {"userName": "public", "relationName": "CUSTOMER", "programName": "adhoc"}, "opId": 42}, {"opName": "MyriaShuffleProducer(h($0))", "opType": "ShuffleProducer", "argChild": 42, "distributeFunction": {"indexes": [0], "type": "Hash"}, "opId": 39}]}, {"operators": [{"debroadcast": false, "opType": "TableScan", "opName": "MyriaScan(public:adhoc:ORDERS)", "relationKey": {"userName": "public", "relationName": "ORDERS", "programName": "adhoc"}, "opId": 43}, {"opName": "MyriaSelect((($4 >= \":2\") and ($4 < \"1995-01-01\")))", "opType": "Filter", "argChild": 43, "argPredicate": {"rootExpressionOperator": {"right": {"right": {"valueType": "STRING_TYPE", "type": "CONSTANT", "value": "1995-01-01"}, "left": {"type": "VARIABLE", "columnIdx": 4}, "type": "LT"}, "left": {"right": {"valueType": "STRING_TYPE", "type": "CONSTANT", "value": ":2"}, "left": {"type": "VARIABLE", "columnIdx": 4}, "type": "GTEQ"}, "type": "AND"}}, "opId": 44}, {"opName": "MyriaShuffleProducer(h($1))", "opType": "ShuffleProducer", "argChild": 44, "distributeFunction": {"indexes": [1], "type": "Hash"}, "opId": 37}]}], "type": "SubQuery"}, "rawQuery": "lineitem = scan('LINEITEM');\nsupplier = scan('SUPPLIER');\nnation = scan('NATION');\nregion = scan('REGION');\ncustomer = scan('CUSTOMER');\norders = scan('ORDERS');\n\n-- $ID$\n-- TPC-H/TPC-R Local Supplier Volume Query (Q5)\n-- Functional Query Definition\n-- Approved February 1998\nq5 = select\n\tN_NAME,\n\tsum(L_EXTENDEDPRICE * (1 - L_DISCOUNT)) as revenue\nfrom\n\tcustomer,\n\torders,\n\tlineitem,\n\tsupplier,\n\tnation,\n\tregion\nwhere\n\tC_CUSTKEY = O_CUSTKEY\n\tand L_ORDERKEY = O_ORDERKEY\n\tand L_SUPPKEY = S_SUPPKEY\n\tand C_NATIONKEY = S_NATIONKEY\n\tand S_NATIONKEY = N_NATIONKEY\n\tand N_REGIONKEY = R_REGIONKEY\n\tand R_NAME = ':1'\n\tand O_ORDERDATE >= ':2'\n\tand O_ORDERDATE < \"1995-01-01\";\n--group by  -- not needed in myriaL\n--\tn_name\n--order by\n--\trevenue desc;\n\nstore(q5, q5);\n", "profilingMode": [], "language": "myrial", "logicalRa": "Store(public:adhoc:q5)[Apply(N_NAME=$0,revenue=$1)[GroupBy($0; SUM($1))[Apply(N_NAME=$2,_COLUMN1_=($0 * (1 - $1)))[ProjectingJoin(($3 = $4); $0,$1,$2)[ProjectingJoin(($39 = $44); $24,$25,$45,$46)[ProjectingJoin((($3 = $39) and ($21 = $36)); $0,$1,$2,$3,$4,$5,$6,$7,$8,$9,$10,$11,$12,$13,$14,$15,$16,$17,$18,$19,$20,$21,$22,$23,$24,$25,$26,$27,$28,$29,$30,$31,$32,$33,$34,$35,$36,$37,$38,$39,$40,$41,$42,$43)[ProjectingJoin(($19 = $9); $0,$1,$2,$3,$4,$5,$6,$7,$8,$9,$10,$11,$12,$13,$14,$15,$16,$17,$18,$19,$20,$21,$22,$23,$24,$25,$26,$27,$28,$29,$30,$31,$32,$33,$34,$35)[ProjectingJoin(($0 = $10); $0,$1,$2,$3,$4,$5,$6,$7,$8,$9,$10,$11,$12,$13,$14,$15,$16,$17,$18)[Scan(public:adhoc:CUSTOMER),Select((($4 < \"1995-01-01\") and ($4 >= \":2\")))[Scan(public:adhoc:ORDERS)]],Scan(public:adhoc:LINEITEM)],Scan(public:adhoc:SUPPLIER)],Scan(public:adhoc:NATION)],Apply(R_REGIONKEY=$0)[Select(($1 = \":1\"))[Scan(public:adhoc:REGION)]]]]]]]"}
