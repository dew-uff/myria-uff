{
    "ftMode": "NONE",
    "language": "myrial",
    "logicalRa": "Store(public:adhoc:q3)[Apply(L_ORDERKEY=$0,revenue=$3,O_ORDERDATE=$1,O_SHIPPRIORITY=$2)[GroupBy($2,$0,$1; SUM($3))[Apply(O_ORDERDATE=$0,O_SHIPPRIORITY=$1,L_ORDERKEY=$2,_COLUMN3_=($3 * (1 - $4)))[ProjectingJoin(($3 = $0); $1,$2,$3,$4,$5)[ProjectingJoin(($0 = $10); $9,$13,$16)[Select(($6 = \":1\"))[Scan(public:adhoc:CUSTOMER)],Select(($4 < \":2\"))[Scan(public:adhoc:ORDERS)]],Apply(L_ORDERKEY=$0,L_EXTENDEDPRICE=$5,L_DISCOUNT=$6)[Select(($10 > \":2\"))[Scan(public:adhoc:LINEITEM)]]]]]]]",
    "plan": {
        "fragments": [
            {
                "operators": [
                    {
                        "argOperatorId": 1,
                        "opId": 0,
                        "opName": "MyriaSplitConsumer",
                        "opType": "LocalMultiwayConsumer"
                    },
                    {
                        "argChild": 0,
                        "emitExpressions": [
                            {
                                "outputName": "L_ORDERKEY",
                                "rootExpressionOperator": {
                                    "columnIdx": 0,
                                    "type": "VARIABLE"
                                }
                            },
                            {
                                "outputName": "revenue",
                                "rootExpressionOperator": {
                                    "columnIdx": 3,
                                    "type": "VARIABLE"
                                }
                            },
                            {
                                "outputName": "O_ORDERDATE",
                                "rootExpressionOperator": {
                                    "columnIdx": 1,
                                    "type": "VARIABLE"
                                }
                            },
                            {
                                "outputName": "O_SHIPPRIORITY",
                                "rootExpressionOperator": {
                                    "columnIdx": 2,
                                    "type": "VARIABLE"
                                }
                            }
                        ],
                        "opId": 2,
                        "opName": "MyriaApply(L_ORDERKEY=$0,revenue=$3,O_ORDERDATE=$1,O_SHIPPRIORITY=$2)",
                        "opType": "Apply"
                    },
                    {
                        "argChild": 2,
                        "argOverwriteTable": true,
                        "distributeFunction": {
                            "indexes": [
                                0,
                                2,
                                3
                            ],
                            "type": "Hash"
                        },
                        "opId": 3,
                        "opName": "MyriaStore(public:adhoc:q3)",
                        "opType": "DbInsert",
                        "relationKey": {
                            "programName": "adhoc",
                            "relationName": "q3",
                            "userName": "public"
                        }
                    }
                ]
            },
            {
                "operators": [
                    {
                        "argOperatorId": 5,
                        "opId": 4,
                        "opName": "MyriaShuffleConsumer",
                        "opType": "ShuffleConsumer"
                    },
                    {
                        "aggregators": [
                            {
                                "aggOps": [
                                    "SUM"
                                ],
                                "column": 3,
                                "type": "Primitive"
                            }
                        ],
                        "argChild": 4,
                        "argGroupFields": [
                            0,
                            1,
                            2
                        ],
                        "opId": 6,
                        "opName": "MyriaGroupBy($0,$1,$2; SUM($3))",
                        "opType": "Aggregate"
                    },
                    {
                        "argChild": 6,
                        "opId": 1,
                        "opName": "MyriaSplitProducer",
                        "opType": "LocalMultiwayProducer"
                    }
                ]
            },
            {
                "operators": [
                    {
                        "argOperatorId": 8,
                        "opId": 7,
                        "opName": "MyriaSplitConsumer",
                        "opType": "LocalMultiwayConsumer"
                    },
                    {
                        "argChild": 7,
                        "emitExpressions": [
                            {
                                "outputName": "O_ORDERDATE",
                                "rootExpressionOperator": {
                                    "columnIdx": 0,
                                    "type": "VARIABLE"
                                }
                            },
                            {
                                "outputName": "O_SHIPPRIORITY",
                                "rootExpressionOperator": {
                                    "columnIdx": 1,
                                    "type": "VARIABLE"
                                }
                            },
                            {
                                "outputName": "L_ORDERKEY",
                                "rootExpressionOperator": {
                                    "columnIdx": 2,
                                    "type": "VARIABLE"
                                }
                            },
                            {
                                "outputName": "_COLUMN3_",
                                "rootExpressionOperator": {
                                    "left": {
                                        "columnIdx": 3,
                                        "type": "VARIABLE"
                                    },
                                    "right": {
                                        "left": {
                                            "type": "CONSTANT",
                                            "value": "1",
                                            "valueType": "LONG_TYPE"
                                        },
                                        "right": {
                                            "columnIdx": 4,
                                            "type": "VARIABLE"
                                        },
                                        "type": "MINUS"
                                    },
                                    "type": "TIMES"
                                }
                            }
                        ],
                        "opId": 9,
                        "opName": "MyriaApply(O_ORDERDATE=$0,O_SHIPPRIORITY=$1,L_ORDERKEY=$2,_COLUMN3_=($3 * (1 - $4)))",
                        "opType": "Apply"
                    },
                    {
                        "aggregators": [
                            {
                                "aggOps": [
                                    "SUM"
                                ],
                                "column": 3,
                                "type": "Primitive"
                            }
                        ],
                        "argChild": 9,
                        "argGroupFields": [
                            2,
                            0,
                            1
                        ],
                        "opId": 10,
                        "opName": "MyriaGroupBy($2,$0,$1; SUM($3))",
                        "opType": "Aggregate"
                    },
                    {
                        "argChild": 10,
                        "distributeFunction": {
                            "indexes": [
                                0,
                                1,
                                2
                            ],
                            "type": "Hash"
                        },
                        "opId": 5,
                        "opName": "MyriaShuffleProducer(h($0,$1,$2))",
                        "opType": "ShuffleProducer"
                    }
                ]
            },
            {
                "operators": [
                    {
                        "argOperatorId": 12,
                        "opId": 11,
                        "opName": "MyriaShuffleConsumer",
                        "opType": "ShuffleConsumer"
                    },
                    {
                        "argOperatorId": 14,
                        "opId": 13,
                        "opName": "MyriaShuffleConsumer",
                        "opType": "ShuffleConsumer"
                    },
                    {
                        "argChild1": "13",
                        "argChild2": "11",
                        "argColumnNames": [
                            "O_ORDERDATE",
                            "O_SHIPPRIORITY",
                            "L_ORDERKEY",
                            "L_EXTENDEDPRICE",
                            "L_DISCOUNT"
                        ],
                        "argColumns1": [
                            0
                        ],
                        "argColumns2": [
                            0
                        ],
                        "argOrder": "ALTERNATE",
                        "argSelect1": [
                            1,
                            2
                        ],
                        "argSelect2": [
                            0,
                            1,
                            2
                        ],
                        "opId": 15,
                        "opName": "MyriaSymmetricHashJoin(($3 = $0); $1,$2,$3,$4,$5)",
                        "opType": "SymmetricHashJoin"
                    },
                    {
                        "argChild": 15,
                        "opId": 8,
                        "opName": "MyriaSplitProducer",
                        "opType": "LocalMultiwayProducer"
                    }
                ]
            },
            {
                "operators": [
                    {
                        "argOperatorId": 17,
                        "opId": 16,
                        "opName": "MyriaShuffleConsumer",
                        "opType": "ShuffleConsumer"
                    },
                    {
                        "argOperatorId": 19,
                        "opId": 18,
                        "opName": "MyriaShuffleConsumer",
                        "opType": "ShuffleConsumer"
                    },
                    {
                        "argChild1": "18",
                        "argChild2": "16",
                        "argColumnNames": [
                            "O_ORDERKEY",
                            "O_ORDERDATE",
                            "O_SHIPPRIORITY"
                        ],
                        "argColumns1": [
                            0
                        ],
                        "argColumns2": [
                            1
                        ],
                        "argOrder": "ALTERNATE",
                        "argSelect1": [],
                        "argSelect2": [
                            0,
                            4,
                            7
                        ],
                        "opId": 20,
                        "opName": "MyriaSymmetricHashJoin(($0 = $10); $9,$13,$16)",
                        "opType": "SymmetricHashJoin"
                    },
                    {
                        "argChild": 20,
                        "distributeFunction": {
                            "indexes": [
                                0
                            ],
                            "type": "Hash"
                        },
                        "opId": 14,
                        "opName": "MyriaShuffleProducer(h($0))",
                        "opType": "ShuffleProducer"
                    }
                ]
            },
            {
                "operators": [
                    {
                        "debroadcast": false,
                        "opId": 21,
                        "opName": "MyriaScan(public:adhoc:LINEITEM)",
                        "opType": "TableScan",
                        "relationKey": {
                            "programName": "adhoc",
                            "relationName": "LINEITEM",
                            "userName": "public"
                        }
                    },
                    {
                        "argChild": 21,
                        "argPredicate": {
                            "rootExpressionOperator": {
                                "left": {
                                    "columnIdx": 10,
                                    "type": "VARIABLE"
                                },
                                "right": {
                                    "type": "CONSTANT",
                                    "value": ":2",
                                    "valueType": "STRING_TYPE"
                                },
                                "type": "GT"
                            }
                        },
                        "opId": 22,
                        "opName": "MyriaSelect(($10 > \":2\"))",
                        "opType": "Filter"
                    },
                    {
                        "argChild": 22,
                        "emitExpressions": [
                            {
                                "outputName": "L_ORDERKEY",
                                "rootExpressionOperator": {
                                    "columnIdx": 0,
                                    "type": "VARIABLE"
                                }
                            },
                            {
                                "outputName": "L_EXTENDEDPRICE",
                                "rootExpressionOperator": {
                                    "columnIdx": 5,
                                    "type": "VARIABLE"
                                }
                            },
                            {
                                "outputName": "L_DISCOUNT",
                                "rootExpressionOperator": {
                                    "columnIdx": 6,
                                    "type": "VARIABLE"
                                }
                            }
                        ],
                        "opId": 23,
                        "opName": "MyriaApply(L_ORDERKEY=$0,L_EXTENDEDPRICE=$5,L_DISCOUNT=$6)",
                        "opType": "Apply"
                    },
                    {
                        "argChild": 23,
                        "distributeFunction": {
                            "indexes": [
                                0
                            ],
                            "type": "Hash"
                        },
                        "opId": 12,
                        "opName": "MyriaShuffleProducer(h($0))",
                        "opType": "ShuffleProducer"
                    }
                ]
            },
            {
                "operators": [
                    {
                        "debroadcast": false,
                        "opId": 24,
                        "opName": "MyriaScan(public:adhoc:CUSTOMER)",
                        "opType": "TableScan",
                        "relationKey": {
                            "programName": "adhoc",
                            "relationName": "CUSTOMER",
                            "userName": "public"
                        }
                    },
                    {
                        "argChild": 24,
                        "argPredicate": {
                            "rootExpressionOperator": {
                                "left": {
                                    "columnIdx": 6,
                                    "type": "VARIABLE"
                                },
                                "right": {
                                    "type": "CONSTANT",
                                    "value": ":1",
                                    "valueType": "STRING_TYPE"
                                },
                                "type": "EQ"
                            }
                        },
                        "opId": 25,
                        "opName": "MyriaSelect(($6 = \":1\"))",
                        "opType": "Filter"
                    },
                    {
                        "argChild": 25,
                        "distributeFunction": {
                            "indexes": [
                                0
                            ],
                            "type": "Hash"
                        },
                        "opId": 19,
                        "opName": "MyriaShuffleProducer(h($0))",
                        "opType": "ShuffleProducer"
                    }
                ]
            },
            {
                "operators": [
                    {
                        "debroadcast": false,
                        "opId": 26,
                        "opName": "MyriaScan(public:adhoc:ORDERS)",
                        "opType": "TableScan",
                        "relationKey": {
                            "programName": "adhoc",
                            "relationName": "ORDERS",
                            "userName": "public"
                        }
                    },
                    {
                        "argChild": 26,
                        "argPredicate": {
                            "rootExpressionOperator": {
                                "left": {
                                    "columnIdx": 4,
                                    "type": "VARIABLE"
                                },
                                "right": {
                                    "type": "CONSTANT",
                                    "value": ":2",
                                    "valueType": "STRING_TYPE"
                                },
                                "type": "LT"
                            }
                        },
                        "opId": 27,
                        "opName": "MyriaSelect(($4 < \":2\"))",
                        "opType": "Filter"
                    },
                    {
                        "argChild": 27,
                        "distributeFunction": {
                            "indexes": [
                                1
                            ],
                            "type": "Hash"
                        },
                        "opId": 17,
                        "opName": "MyriaShuffleProducer(h($1))",
                        "opType": "ShuffleProducer"
                    }
                ]
            }
        ],
        "type": "SubQuery"
    },
    "profilingMode": [],
    "rawQuery": "lineitem = scan('LINEITEM');\ncustomer = scan('CUSTOMER');\norders = scan('ORDERS');\n-- $ID$\n-- TPC-H/TPC-R Shipping Priority Query (Q3)\n-- Functional Query Definition\n-- Approved February 1998\n\nq3 = select\n\tL_ORDERKEY,\n\tsum(L_EXTENDEDPRICE * (1 - L_DISCOUNT)) as revenue,\n\tO_ORDERDATE,\n\tO_SHIPPRIORITY\nfrom\n\tcustomer,\n\torders,\n\tlineitem\nwhere\n\tC_MKTSEGMENT = ':1'\n\tand C_CUSTKEY = O_CUSTKEY\n\tand L_ORDERKEY = O_ORDERKEY\n\tand O_ORDERDATE < ':2'\n\tand L_SHIPDATE > ':2';\n--group by         -- myrial doesn't need these\n--\tl_orderkey,\n--\to_orderdate,\n--\to_shippriority\n--TODO order by\n--TODO \trevenue desc,\n--TODO \to_orderdate;\n\nstore(q3, q3);"
}