{
    "ftMode": "NONE",
    "language": "myrial",
    "logicalRa": "Store(public:adhoc:q5)[Apply(N_NAME=$0,revenue=$1)[GroupBy($0; SUM($1))[Apply(N_NAME=$2,_COLUMN1_=($0 * (1 - $1)))[ProjectingJoin(($3 = $4); $0,$1,$2)[ProjectingJoin(($39 = $44); $24,$25,$45,$46)[ProjectingJoin((($3 = $39) and ($21 = $36)); $0,$1,$2,$3,$4,$5,$6,$7,$8,$9,$10,$11,$12,$13,$14,$15,$16,$17,$18,$19,$20,$21,$22,$23,$24,$25,$26,$27,$28,$29,$30,$31,$32,$33,$34,$35,$36,$37,$38,$39,$40,$41,$42,$43)[ProjectingJoin(($19 = $9); $0,$1,$2,$3,$4,$5,$6,$7,$8,$9,$10,$11,$12,$13,$14,$15,$16,$17,$18,$19,$20,$21,$22,$23,$24,$25,$26,$27,$28,$29,$30,$31,$32,$33,$34,$35)[ProjectingJoin(($0 = $10); $0,$1,$2,$3,$4,$5,$6,$7,$8,$9,$10,$11,$12,$13,$14,$15,$16,$17,$18)[Scan(public:adhoc:CUSTOMER),Select((($4 < \"1995-01-01\") and ($4 >= \":2\")))[Scan(public:adhoc:ORDERS)]],Scan(public:adhoc:LINEITEM)],Scan(public:adhoc:SUPPLIER)],Scan(public:adhoc:NATION)],Apply(R_REGIONKEY=$0)[Select(($1 = \":1\"))[Scan(public:adhoc:REGION)]]]]]]]",
    "plan": {
        "fragments": [
            {
                "operators": [
                    {
                        "argOperatorId": 1,
                        "opId": 0,
                        "opName": "MyriaSplitConsumer",
                        "opType": "LocalMultiwayConsumer"
                    },
                    {
                        "argChild": 0,
                        "emitExpressions": [
                            {
                                "outputName": "N_NAME",
                                "rootExpressionOperator": {
                                    "columnIdx": 0,
                                    "type": "VARIABLE"
                                }
                            },
                            {
                                "outputName": "revenue",
                                "rootExpressionOperator": {
                                    "columnIdx": 1,
                                    "type": "VARIABLE"
                                }
                            }
                        ],
                        "opId": 2,
                        "opName": "MyriaApply(N_NAME=$0,revenue=$1)",
                        "opType": "Apply"
                    },
                    {
                        "argChild": 2,
                        "argOverwriteTable": true,
                        "distributeFunction": {
                            "indexes": [
                                0
                            ],
                            "type": "Hash"
                        },
                        "opId": 3,
                        "opName": "MyriaStore(public:adhoc:q5)",
                        "opType": "DbInsert",
                        "relationKey": {
                            "programName": "adhoc",
                            "relationName": "q5",
                            "userName": "public"
                        }
                    }
                ]
            },
            {
                "operators": [
                    {
                        "argOperatorId": 5,
                        "opId": 4,
                        "opName": "MyriaShuffleConsumer",
                        "opType": "ShuffleConsumer"
                    },
                    {
                        "aggregators": [
                            {
                                "aggOps": [
                                    "SUM"
                                ],
                                "column": 1,
                                "type": "Primitive"
                            }
                        ],
                        "argChild": 4,
                        "argGroupFields": [
                            0
                        ],
                        "opId": 6,
                        "opName": "MyriaGroupBy($0; SUM($1))",
                        "opType": "Aggregate"
                    },
                    {
                        "argChild": 6,
                        "opId": 1,
                        "opName": "MyriaSplitProducer",
                        "opType": "LocalMultiwayProducer"
                    }
                ]
            },
            {
                "operators": [
                    {
                        "argOperatorId": 8,
                        "opId": 7,
                        "opName": "MyriaSplitConsumer",
                        "opType": "LocalMultiwayConsumer"
                    },
                    {
                        "argChild": 7,
                        "emitExpressions": [
                            {
                                "outputName": "N_NAME",
                                "rootExpressionOperator": {
                                    "columnIdx": 2,
                                    "type": "VARIABLE"
                                }
                            },
                            {
                                "outputName": "_COLUMN1_",
                                "rootExpressionOperator": {
                                    "left": {
                                        "columnIdx": 0,
                                        "type": "VARIABLE"
                                    },
                                    "right": {
                                        "left": {
                                            "type": "CONSTANT",
                                            "value": "1",
                                            "valueType": "LONG_TYPE"
                                        },
                                        "right": {
                                            "columnIdx": 1,
                                            "type": "VARIABLE"
                                        },
                                        "type": "MINUS"
                                    },
                                    "type": "TIMES"
                                }
                            }
                        ],
                        "opId": 9,
                        "opName": "MyriaApply(N_NAME=$2,_COLUMN1_=($0 * (1 - $1)))",
                        "opType": "Apply"
                    },
                    {
                        "aggregators": [
                            {
                                "aggOps": [
                                    "SUM"
                                ],
                                "column": 1,
                                "type": "Primitive"
                            }
                        ],
                        "argChild": 9,
                        "argGroupFields": [
                            0
                        ],
                        "opId": 10,
                        "opName": "MyriaGroupBy($0; SUM($1))",
                        "opType": "Aggregate"
                    },
                    {
                        "argChild": 10,
                        "distributeFunction": {
                            "indexes": [
                                0
                            ],
                            "type": "Hash"
                        },
                        "opId": 5,
                        "opName": "MyriaShuffleProducer(h($0))",
                        "opType": "ShuffleProducer"
                    }
                ]
            },
            {
                "operators": [
                    {
                        "argOperatorId": 12,
                        "opId": 11,
                        "opName": "MyriaShuffleConsumer",
                        "opType": "ShuffleConsumer"
                    },
                    {
                        "argOperatorId": 14,
                        "opId": 13,
                        "opName": "MyriaShuffleConsumer",
                        "opType": "ShuffleConsumer"
                    },
                    {
                        "argChild1": "13",
                        "argChild2": "11",
                        "argColumnNames": [
                            "L_EXTENDEDPRICE",
                            "L_DISCOUNT",
                            "N_NAME"
                        ],
                        "argColumns1": [
                            3
                        ],
                        "argColumns2": [
                            0
                        ],
                        "argOrder": "ALTERNATE",
                        "argSelect1": [
                            0,
                            1,
                            2
                        ],
                        "argSelect2": [],
                        "opId": 15,
                        "opName": "MyriaSymmetricHashJoin(($3 = $4); $0,$1,$2)",
                        "opType": "SymmetricHashJoin"
                    },
                    {
                        "argChild": 15,
                        "opId": 8,
                        "opName": "MyriaSplitProducer",
                        "opType": "LocalMultiwayProducer"
                    }
                ]
            },
            {
                "operators": [
                    {
                        "argOperatorId": 17,
                        "opId": 16,
                        "opName": "MyriaShuffleConsumer",
                        "opType": "ShuffleConsumer"
                    },
                    {
                        "argOperatorId": 19,
                        "opId": 18,
                        "opName": "MyriaShuffleConsumer",
                        "opType": "ShuffleConsumer"
                    },
                    {
                        "argChild1": "18",
                        "argChild2": "16",
                        "argColumnNames": [
                            "L_EXTENDEDPRICE",
                            "L_DISCOUNT",
                            "N_NAME",
                            "N_REGIONKEY"
                        ],
                        "argColumns1": [
                            39
                        ],
                        "argColumns2": [
                            0
                        ],
                        "argOrder": "ALTERNATE",
                        "argSelect1": [
                            24,
                            25
                        ],
                        "argSelect2": [
                            1,
                            2
                        ],
                        "opId": 20,
                        "opName": "MyriaSymmetricHashJoin(($39 = $44); $24,$25,$45,$46)",
                        "opType": "SymmetricHashJoin"
                    },
                    {
                        "argChild": 20,
                        "distributeFunction": {
                            "indexes": [
                                3
                            ],
                            "type": "Hash"
                        },
                        "opId": 14,
                        "opName": "MyriaShuffleProducer(h($3))",
                        "opType": "ShuffleProducer"
                    }
                ]
            },
            {
                "operators": [
                    {
                        "debroadcast": false,
                        "opId": 21,
                        "opName": "MyriaScan(public:adhoc:REGION)",
                        "opType": "TableScan",
                        "relationKey": {
                            "programName": "adhoc",
                            "relationName": "REGION",
                            "userName": "public"
                        }
                    },
                    {
                        "argChild": 21,
                        "argPredicate": {
                            "rootExpressionOperator": {
                                "left": {
                                    "columnIdx": 1,
                                    "type": "VARIABLE"
                                },
                                "right": {
                                    "type": "CONSTANT",
                                    "value": ":1",
                                    "valueType": "STRING_TYPE"
                                },
                                "type": "EQ"
                            }
                        },
                        "opId": 22,
                        "opName": "MyriaSelect(($1 = \":1\"))",
                        "opType": "Filter"
                    },
                    {
                        "argChild": 22,
                        "emitExpressions": [
                            {
                                "outputName": "R_REGIONKEY",
                                "rootExpressionOperator": {
                                    "columnIdx": 0,
                                    "type": "VARIABLE"
                                }
                            }
                        ],
                        "opId": 23,
                        "opName": "MyriaApply(R_REGIONKEY=$0)",
                        "opType": "Apply"
                    },
                    {
                        "argChild": 23,
                        "distributeFunction": {
                            "indexes": [
                                0
                            ],
                            "type": "Hash"
                        },
                        "opId": 12,
                        "opName": "MyriaShuffleProducer(h($0))",
                        "opType": "ShuffleProducer"
                    }
                ]
            },
            {
                "operators": [
                    {
                        "argOperatorId": 25,
                        "opId": 24,
                        "opName": "MyriaShuffleConsumer",
                        "opType": "ShuffleConsumer"
                    },
                    {
                        "argOperatorId": 27,
                        "opId": 26,
                        "opName": "MyriaShuffleConsumer",
                        "opType": "ShuffleConsumer"
                    },
                    {
                        "argChild1": "26",
                        "argChild2": "24",
                        "argColumnNames": [
                            "C_CUSTKEY",
                            "C_NAME",
                            "C_ADDRESS",
                            "C_NATIONKEY",
                            "C_PHONE",
                            "C_ACCTBAL",
                            "C_MKTSEGMENT",
                            "C_COMMENT",
                            "C_RANDOM",
                            "O_ORDERKEY",
                            "O_CUSTKEY",
                            "O_ORDERSTATUS",
                            "O_TOTALPRICE",
                            "O_ORDERDATE",
                            "O_ORDERPRIORITY",
                            "O_CLERK",
                            "O_SHIPPRIORITY",
                            "O_COMMENT",
                            "O_RANDOM",
                            "L_ORDERKEY",
                            "L_PARTKEY",
                            "L_SUPPKEY",
                            "L_LINENUMBER",
                            "L_QUANTITY",
                            "L_EXTENDEDPRICE",
                            "L_DISCOUNT",
                            "L_TAX",
                            "L_RETURNFLAG",
                            "L_LINESTATUS",
                            "L_SHIPDATE",
                            "L_COMMITDATE",
                            "L_RECEIPTDATE",
                            "L_SHIPINSTRUCT",
                            "L_SHIPMODE",
                            "L_COMMENT",
                            "L_RANDOM",
                            "S_SUPPKEY",
                            "S_NAME",
                            "S_ADDRESS",
                            "S_NATIONKEY",
                            "S_PHONE",
                            "S_ACCTBAL",
                            "S_COMMENT",
                            "S_RANDOM"
                        ],
                        "argColumns1": [
                            3,
                            21
                        ],
                        "argColumns2": [
                            3,
                            0
                        ],
                        "argOrder": "ALTERNATE",
                        "argSelect1": [
                            0,
                            1,
                            2,
                            3,
                            4,
                            5,
                            6,
                            7,
                            8,
                            9,
                            10,
                            11,
                            12,
                            13,
                            14,
                            15,
                            16,
                            17,
                            18,
                            19,
                            20,
                            21,
                            22,
                            23,
                            24,
                            25,
                            26,
                            27,
                            28,
                            29,
                            30,
                            31,
                            32,
                            33,
                            34,
                            35
                        ],
                        "argSelect2": [
                            0,
                            1,
                            2,
                            3,
                            4,
                            5,
                            6,
                            7
                        ],
                        "opId": 28,
                        "opName": "MyriaSymmetricHashJoin((($3 = $39) and ($21 = $36)); $0,$1,$2,$3,$4,$5,$6,$7,$8,$9,$10,$11,$12,$13,$14,$15,$16,$17,$18,$19,$20,$21,$22,$23,$24,$25,$26,$27,$28,$29,$30,$31,$32,$33,$34,$35,$36,$37,$38,$39,$40,$41,$42,$43)",
                        "opType": "SymmetricHashJoin"
                    },
                    {
                        "argChild": 28,
                        "distributeFunction": {
                            "indexes": [
                                39
                            ],
                            "type": "Hash"
                        },
                        "opId": 19,
                        "opName": "MyriaShuffleProducer(h($39))",
                        "opType": "ShuffleProducer"
                    }
                ]
            },
            {
                "operators": [
                    {
                        "debroadcast": false,
                        "opId": 29,
                        "opName": "MyriaScan(public:adhoc:NATION)",
                        "opType": "TableScan",
                        "relationKey": {
                            "programName": "adhoc",
                            "relationName": "NATION",
                            "userName": "public"
                        }
                    },
                    {
                        "argChild": 29,
                        "distributeFunction": {
                            "indexes": [
                                0
                            ],
                            "type": "Hash"
                        },
                        "opId": 17,
                        "opName": "MyriaShuffleProducer(h($0))",
                        "opType": "ShuffleProducer"
                    }
                ]
            },
            {
                "operators": [
                    {
                        "argOperatorId": 31,
                        "opId": 30,
                        "opName": "MyriaShuffleConsumer",
                        "opType": "ShuffleConsumer"
                    },
                    {
                        "argOperatorId": 33,
                        "opId": 32,
                        "opName": "MyriaShuffleConsumer",
                        "opType": "ShuffleConsumer"
                    },
                    {
                        "argChild1": "32",
                        "argChild2": "30",
                        "argColumnNames": [
                            "C_CUSTKEY",
                            "C_NAME",
                            "C_ADDRESS",
                            "C_NATIONKEY",
                            "C_PHONE",
                            "C_ACCTBAL",
                            "C_MKTSEGMENT",
                            "C_COMMENT",
                            "C_RANDOM",
                            "O_ORDERKEY",
                            "O_CUSTKEY",
                            "O_ORDERSTATUS",
                            "O_TOTALPRICE",
                            "O_ORDERDATE",
                            "O_ORDERPRIORITY",
                            "O_CLERK",
                            "O_SHIPPRIORITY",
                            "O_COMMENT",
                            "O_RANDOM",
                            "L_ORDERKEY",
                            "L_PARTKEY",
                            "L_SUPPKEY",
                            "L_LINENUMBER",
                            "L_QUANTITY",
                            "L_EXTENDEDPRICE",
                            "L_DISCOUNT",
                            "L_TAX",
                            "L_RETURNFLAG",
                            "L_LINESTATUS",
                            "L_SHIPDATE",
                            "L_COMMITDATE",
                            "L_RECEIPTDATE",
                            "L_SHIPINSTRUCT",
                            "L_SHIPMODE",
                            "L_COMMENT",
                            "L_RANDOM"
                        ],
                        "argColumns1": [
                            9
                        ],
                        "argColumns2": [
                            0
                        ],
                        "argOrder": "ALTERNATE",
                        "argSelect1": [
                            0,
                            1,
                            2,
                            3,
                            4,
                            5,
                            6,
                            7,
                            8,
                            9,
                            10,
                            11,
                            12,
                            13,
                            14,
                            15,
                            16,
                            17,
                            18
                        ],
                        "argSelect2": [
                            0,
                            1,
                            2,
                            3,
                            4,
                            5,
                            6,
                            7,
                            8,
                            9,
                            10,
                            11,
                            12,
                            13,
                            14,
                            15,
                            16
                        ],
                        "opId": 34,
                        "opName": "MyriaSymmetricHashJoin(($19 = $9); $0,$1,$2,$3,$4,$5,$6,$7,$8,$9,$10,$11,$12,$13,$14,$15,$16,$17,$18,$19,$20,$21,$22,$23,$24,$25,$26,$27,$28,$29,$30,$31,$32,$33,$34,$35)",
                        "opType": "SymmetricHashJoin"
                    },
                    {
                        "argChild": 34,
                        "distributeFunction": {
                            "indexes": [
                                3,
                                21
                            ],
                            "type": "Hash"
                        },
                        "opId": 27,
                        "opName": "MyriaShuffleProducer(h($3,$21))",
                        "opType": "ShuffleProducer"
                    }
                ]
            },
            {
                "operators": [
                    {
                        "debroadcast": false,
                        "opId": 35,
                        "opName": "MyriaScan(public:adhoc:SUPPLIER)",
                        "opType": "TableScan",
                        "relationKey": {
                            "programName": "adhoc",
                            "relationName": "SUPPLIER",
                            "userName": "public"
                        }
                    },
                    {
                        "argChild": 35,
                        "distributeFunction": {
                            "indexes": [
                                3,
                                0
                            ],
                            "type": "Hash"
                        },
                        "opId": 25,
                        "opName": "MyriaShuffleProducer(h($3,$0))",
                        "opType": "ShuffleProducer"
                    }
                ]
            },
            {
                "operators": [
                    {
                        "argOperatorId": 37,
                        "opId": 36,
                        "opName": "MyriaShuffleConsumer",
                        "opType": "ShuffleConsumer"
                    },
                    {
                        "argOperatorId": 39,
                        "opId": 38,
                        "opName": "MyriaShuffleConsumer",
                        "opType": "ShuffleConsumer"
                    },
                    {
                        "argChild1": "38",
                        "argChild2": "36",
                        "argColumnNames": [
                            "C_CUSTKEY",
                            "C_NAME",
                            "C_ADDRESS",
                            "C_NATIONKEY",
                            "C_PHONE",
                            "C_ACCTBAL",
                            "C_MKTSEGMENT",
                            "C_COMMENT",
                            "C_RANDOM",
                            "O_ORDERKEY",
                            "O_CUSTKEY",
                            "O_ORDERSTATUS",
                            "O_TOTALPRICE",
                            "O_ORDERDATE",
                            "O_ORDERPRIORITY",
                            "O_CLERK",
                            "O_SHIPPRIORITY",
                            "O_COMMENT",
                            "O_RANDOM"
                        ],
                        "argColumns1": [
                            0
                        ],
                        "argColumns2": [
                            1
                        ],
                        "argOrder": "ALTERNATE",
                        "argSelect1": [
                            0,
                            1,
                            2,
                            3,
                            4,
                            5,
                            6,
                            7,
                            8
                        ],
                        "argSelect2": [
                            0,
                            1,
                            2,
                            3,
                            4,
                            5,
                            6,
                            7,
                            8,
                            9
                        ],
                        "opId": 40,
                        "opName": "MyriaSymmetricHashJoin(($0 = $10); $0,$1,$2,$3,$4,$5,$6,$7,$8,$9,$10,$11,$12,$13,$14,$15,$16,$17,$18)",
                        "opType": "SymmetricHashJoin"
                    },
                    {
                        "argChild": 40,
                        "distributeFunction": {
                            "indexes": [
                                9
                            ],
                            "type": "Hash"
                        },
                        "opId": 33,
                        "opName": "MyriaShuffleProducer(h($9))",
                        "opType": "ShuffleProducer"
                    }
                ]
            },
            {
                "operators": [
                    {
                        "debroadcast": false,
                        "opId": 41,
                        "opName": "MyriaScan(public:adhoc:LINEITEM)",
                        "opType": "TableScan",
                        "relationKey": {
                            "programName": "adhoc",
                            "relationName": "LINEITEM",
                            "userName": "public"
                        }
                    },
                    {
                        "argChild": 41,
                        "distributeFunction": {
                            "indexes": [
                                0
                            ],
                            "type": "Hash"
                        },
                        "opId": 31,
                        "opName": "MyriaShuffleProducer(h($0))",
                        "opType": "ShuffleProducer"
                    }
                ]
            },
            {
                "operators": [
                    {
                        "debroadcast": false,
                        "opId": 42,
                        "opName": "MyriaScan(public:adhoc:CUSTOMER)",
                        "opType": "TableScan",
                        "relationKey": {
                            "programName": "adhoc",
                            "relationName": "CUSTOMER",
                            "userName": "public"
                        }
                    },
                    {
                        "argChild": 42,
                        "distributeFunction": {
                            "indexes": [
                                0
                            ],
                            "type": "Hash"
                        },
                        "opId": 39,
                        "opName": "MyriaShuffleProducer(h($0))",
                        "opType": "ShuffleProducer"
                    }
                ]
            },
            {
                "operators": [
                    {
                        "debroadcast": false,
                        "opId": 43,
                        "opName": "MyriaScan(public:adhoc:ORDERS)",
                        "opType": "TableScan",
                        "relationKey": {
                            "programName": "adhoc",
                            "relationName": "ORDERS",
                            "userName": "public"
                        }
                    },
                    {
                        "argChild": 43,
                        "argPredicate": {
                            "rootExpressionOperator": {
                                "left": {
                                    "left": {
                                        "columnIdx": 4,
                                        "type": "VARIABLE"
                                    },
                                    "right": {
                                        "type": "CONSTANT",
                                        "value": ":2",
                                        "valueType": "STRING_TYPE"
                                    },
                                    "type": "GTEQ"
                                },
                                "right": {
                                    "left": {
                                        "columnIdx": 4,
                                        "type": "VARIABLE"
                                    },
                                    "right": {
                                        "type": "CONSTANT",
                                        "value": "1995-01-01",
                                        "valueType": "STRING_TYPE"
                                    },
                                    "type": "LT"
                                },
                                "type": "AND"
                            }
                        },
                        "opId": 44,
                        "opName": "MyriaSelect((($4 >= \":2\") and ($4 < \"1995-01-01\")))",
                        "opType": "Filter"
                    },
                    {
                        "argChild": 44,
                        "distributeFunction": {
                            "indexes": [
                                1
                            ],
                            "type": "Hash"
                        },
                        "opId": 37,
                        "opName": "MyriaShuffleProducer(h($1))",
                        "opType": "ShuffleProducer"
                    }
                ]
            }
        ],
        "type": "SubQuery"
    },
    "profilingMode": [],
    "rawQuery": "lineitem = scan('LINEITEM');\nsupplier = scan('SUPPLIER');\nnation = scan('NATION');\nregion = scan('REGION');\ncustomer = scan('CUSTOMER');\norders = scan('ORDERS');\n\n-- $ID$\n-- TPC-H/TPC-R Local Supplier Volume Query (Q5)\n-- Functional Query Definition\n-- Approved February 1998\nq5 = select\n\tN_NAME,\n\tsum(L_EXTENDEDPRICE * (1 - L_DISCOUNT)) as revenue\nfrom\n\tcustomer,\n\torders,\n\tlineitem,\n\tsupplier,\n\tnation,\n\tregion\nwhere\n\tC_CUSTKEY = O_CUSTKEY\n\tand L_ORDERKEY = O_ORDERKEY\n\tand L_SUPPKEY = S_SUPPKEY\n\tand C_NATIONKEY = S_NATIONKEY\n\tand S_NATIONKEY = N_NATIONKEY\n\tand N_REGIONKEY = R_REGIONKEY\n\tand R_NAME = ':1'\n\tand O_ORDERDATE >= ':2'\n\tand O_ORDERDATE < \"1995-01-01\";\n--group by  -- not needed in myriaL\n--\tn_name\n--order by\n--\trevenue desc;\n\nstore(q5, q5);\n"
}