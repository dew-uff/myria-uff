{
    "ftMode": "NONE",
    "language": "myrial",
    "logicalRa": "Store(public:adhoc:q4)[Apply(O_ORDERPRIORITY=$0,ORDER_COUNT=$1)[GroupBy($0; COUNT($0))[ProjectingJoin(($2 = $0); $1)[Apply(O_ORDERKEY=$0,O_ORDERPRIORITY=$5)[Select((($4 < \"1993-10-01\") and ($4 >= \":1\")))[Scan(public:adhoc:ORDERS)]],Apply(e_key=$0)[Select(($1 > 0))[GroupBy($0; COUNT($0))[ProjectingJoin(($0 = $1); $1)[Apply(L_ORDERKEY=$0)[Select(($11 < $12))[Scan(public:adhoc:LINEITEM)]],Apply(O_ORDERKEY=$0)[Scan(public:adhoc:ORDERS)]]]]]]]]]",
    "plan": {
        "fragments": [
            {
                "operators": [
                    {
                        "argOperatorId": 1,
                        "opId": 0,
                        "opName": "MyriaSplitConsumer",
                        "opType": "LocalMultiwayConsumer"
                    },
                    {
                        "argChild": 0,
                        "emitExpressions": [
                            {
                                "outputName": "O_ORDERPRIORITY",
                                "rootExpressionOperator": {
                                    "columnIdx": 0,
                                    "type": "VARIABLE"
                                }
                            },
                            {
                                "outputName": "ORDER_COUNT",
                                "rootExpressionOperator": {
                                    "columnIdx": 1,
                                    "type": "VARIABLE"
                                }
                            }
                        ],
                        "opId": 2,
                        "opName": "MyriaApply(O_ORDERPRIORITY=$0,ORDER_COUNT=$1)",
                        "opType": "Apply"
                    },
                    {
                        "argChild": 2,
                        "argOverwriteTable": true,
                        "distributeFunction": {
                            "indexes": [
                                0
                            ],
                            "type": "Hash"
                        },
                        "opId": 3,
                        "opName": "MyriaStore(public:adhoc:q4)",
                        "opType": "DbInsert",
                        "relationKey": {
                            "programName": "adhoc",
                            "relationName": "q4",
                            "userName": "public"
                        }
                    }
                ]
            },
            {
                "operators": [
                    {
                        "argOperatorId": 5,
                        "opId": 4,
                        "opName": "MyriaShuffleConsumer",
                        "opType": "ShuffleConsumer"
                    },
                    {
                        "aggregators": [
                            {
                                "aggOps": [
                                    "SUM"
                                ],
                                "column": 1,
                                "type": "Primitive"
                            }
                        ],
                        "argChild": 4,
                        "argGroupFields": [
                            0
                        ],
                        "opId": 6,
                        "opName": "MyriaGroupBy($0; SUM($1))",
                        "opType": "Aggregate"
                    },
                    {
                        "argChild": 6,
                        "opId": 1,
                        "opName": "MyriaSplitProducer",
                        "opType": "LocalMultiwayProducer"
                    }
                ]
            },
            {
                "operators": [
                    {
                        "argOperatorId": 8,
                        "opId": 7,
                        "opName": "MyriaSplitConsumer",
                        "opType": "LocalMultiwayConsumer"
                    },
                    {
                        "aggregators": [
                            {
                                "aggOps": [
                                    "COUNT"
                                ],
                                "column": 0,
                                "type": "Primitive"
                            }
                        ],
                        "argChild": 7,
                        "argGroupFields": [
                            0
                        ],
                        "opId": 9,
                        "opName": "MyriaGroupBy($0; COUNTALL)",
                        "opType": "Aggregate"
                    },
                    {
                        "argChild": 9,
                        "distributeFunction": {
                            "indexes": [
                                0
                            ],
                            "type": "Hash"
                        },
                        "opId": 5,
                        "opName": "MyriaShuffleProducer(h($0))",
                        "opType": "ShuffleProducer"
                    }
                ]
            },
            {
                "operators": [
                    {
                        "argOperatorId": 11,
                        "opId": 10,
                        "opName": "MyriaShuffleConsumer",
                        "opType": "ShuffleConsumer"
                    },
                    {
                        "argOperatorId": 13,
                        "opId": 12,
                        "opName": "MyriaShuffleConsumer",
                        "opType": "ShuffleConsumer"
                    },
                    {
                        "argChild1": "12",
                        "argChild2": "10",
                        "argColumnNames": [
                            "O_ORDERPRIORITY"
                        ],
                        "argColumns1": [
                            0
                        ],
                        "argColumns2": [
                            0
                        ],
                        "argOrder": "ALTERNATE",
                        "argSelect1": [
                            1
                        ],
                        "argSelect2": [],
                        "opId": 14,
                        "opName": "MyriaSymmetricHashJoin(($2 = $0); $1)",
                        "opType": "SymmetricHashJoin"
                    },
                    {
                        "argChild": 14,
                        "opId": 8,
                        "opName": "MyriaSplitProducer",
                        "opType": "LocalMultiwayProducer"
                    }
                ]
            },
            {
                "operators": [
                    {
                        "debroadcast": false,
                        "opId": 15,
                        "opName": "MyriaScan(public:adhoc:ORDERS)",
                        "opType": "TableScan",
                        "relationKey": {
                            "programName": "adhoc",
                            "relationName": "ORDERS",
                            "userName": "public"
                        }
                    },
                    {
                        "argChild": 15,
                        "argPredicate": {
                            "rootExpressionOperator": {
                                "left": {
                                    "left": {
                                        "columnIdx": 4,
                                        "type": "VARIABLE"
                                    },
                                    "right": {
                                        "type": "CONSTANT",
                                        "value": ":1",
                                        "valueType": "STRING_TYPE"
                                    },
                                    "type": "GTEQ"
                                },
                                "right": {
                                    "left": {
                                        "columnIdx": 4,
                                        "type": "VARIABLE"
                                    },
                                    "right": {
                                        "type": "CONSTANT",
                                        "value": "1993-10-01",
                                        "valueType": "STRING_TYPE"
                                    },
                                    "type": "LT"
                                },
                                "type": "AND"
                            }
                        },
                        "opId": 16,
                        "opName": "MyriaSelect((($4 >= \":1\") and ($4 < \"1993-10-01\")))",
                        "opType": "Filter"
                    },
                    {
                        "argChild": 16,
                        "emitExpressions": [
                            {
                                "outputName": "O_ORDERKEY",
                                "rootExpressionOperator": {
                                    "columnIdx": 0,
                                    "type": "VARIABLE"
                                }
                            },
                            {
                                "outputName": "O_ORDERPRIORITY",
                                "rootExpressionOperator": {
                                    "columnIdx": 5,
                                    "type": "VARIABLE"
                                }
                            }
                        ],
                        "opId": 17,
                        "opName": "MyriaApply(O_ORDERKEY=$0,O_ORDERPRIORITY=$5)",
                        "opType": "Apply"
                    },
                    {
                        "argChild": 17,
                        "distributeFunction": {
                            "indexes": [
                                0
                            ],
                            "type": "Hash"
                        },
                        "opId": 13,
                        "opName": "MyriaShuffleProducer(h($0))",
                        "opType": "ShuffleProducer"
                    }
                ]
            },
            {
                "operators": [
                    {
                        "argOperatorId": 19,
                        "opId": 18,
                        "opName": "MyriaShuffleConsumer",
                        "opType": "ShuffleConsumer"
                    },
                    {
                        "aggregators": [
                            {
                                "aggOps": [
                                    "SUM"
                                ],
                                "column": 1,
                                "type": "Primitive"
                            }
                        ],
                        "argChild": 18,
                        "argGroupFields": [
                            0
                        ],
                        "opId": 20,
                        "opName": "MyriaGroupBy($0; SUM($1))",
                        "opType": "Aggregate"
                    },
                    {
                        "argChild": 20,
                        "argPredicate": {
                            "rootExpressionOperator": {
                                "left": {
                                    "columnIdx": 1,
                                    "type": "VARIABLE"
                                },
                                "right": {
                                    "type": "CONSTANT",
                                    "value": "0",
                                    "valueType": "LONG_TYPE"
                                },
                                "type": "GT"
                            }
                        },
                        "opId": 21,
                        "opName": "MyriaSelect(($1 > 0))",
                        "opType": "Filter"
                    },
                    {
                        "argChild": 21,
                        "emitExpressions": [
                            {
                                "outputName": "e_key",
                                "rootExpressionOperator": {
                                    "columnIdx": 0,
                                    "type": "VARIABLE"
                                }
                            }
                        ],
                        "opId": 22,
                        "opName": "MyriaApply(e_key=$0)",
                        "opType": "Apply"
                    },
                    {
                        "argChild": 22,
                        "distributeFunction": {
                            "indexes": [
                                0
                            ],
                            "type": "Hash"
                        },
                        "opId": 11,
                        "opName": "MyriaShuffleProducer(h($0))",
                        "opType": "ShuffleProducer"
                    }
                ]
            },
            {
                "operators": [
                    {
                        "argOperatorId": 24,
                        "opId": 23,
                        "opName": "MyriaSplitConsumer",
                        "opType": "LocalMultiwayConsumer"
                    },
                    {
                        "aggregators": [
                            {
                                "aggOps": [
                                    "COUNT"
                                ],
                                "column": 0,
                                "type": "Primitive"
                            }
                        ],
                        "argChild": 23,
                        "argGroupFields": [
                            0
                        ],
                        "opId": 25,
                        "opName": "MyriaGroupBy($0; COUNTALL)",
                        "opType": "Aggregate"
                    },
                    {
                        "argChild": 25,
                        "distributeFunction": {
                            "indexes": [
                                0
                            ],
                            "type": "Hash"
                        },
                        "opId": 19,
                        "opName": "MyriaShuffleProducer(h($0))",
                        "opType": "ShuffleProducer"
                    }
                ]
            },
            {
                "operators": [
                    {
                        "argOperatorId": 27,
                        "opId": 26,
                        "opName": "MyriaShuffleConsumer",
                        "opType": "ShuffleConsumer"
                    },
                    {
                        "argOperatorId": 29,
                        "opId": 28,
                        "opName": "MyriaShuffleConsumer",
                        "opType": "ShuffleConsumer"
                    },
                    {
                        "argChild1": "28",
                        "argChild2": "26",
                        "argColumnNames": [
                            "O_ORDERKEY"
                        ],
                        "argColumns1": [
                            0
                        ],
                        "argColumns2": [
                            0
                        ],
                        "argOrder": "ALTERNATE",
                        "argSelect1": [],
                        "argSelect2": [
                            0
                        ],
                        "opId": 30,
                        "opName": "MyriaSymmetricHashJoin(($0 = $1); $1)",
                        "opType": "SymmetricHashJoin"
                    },
                    {
                        "argChild": 30,
                        "opId": 24,
                        "opName": "MyriaSplitProducer",
                        "opType": "LocalMultiwayProducer"
                    }
                ]
            },
            {
                "operators": [
                    {
                        "debroadcast": false,
                        "opId": 31,
                        "opName": "MyriaScan(public:adhoc:LINEITEM)",
                        "opType": "TableScan",
                        "relationKey": {
                            "programName": "adhoc",
                            "relationName": "LINEITEM",
                            "userName": "public"
                        }
                    },
                    {
                        "argChild": 31,
                        "argPredicate": {
                            "rootExpressionOperator": {
                                "left": {
                                    "columnIdx": 11,
                                    "type": "VARIABLE"
                                },
                                "right": {
                                    "columnIdx": 12,
                                    "type": "VARIABLE"
                                },
                                "type": "LT"
                            }
                        },
                        "opId": 32,
                        "opName": "MyriaSelect(($11 < $12))",
                        "opType": "Filter"
                    },
                    {
                        "argChild": 32,
                        "emitExpressions": [
                            {
                                "outputName": "L_ORDERKEY",
                                "rootExpressionOperator": {
                                    "columnIdx": 0,
                                    "type": "VARIABLE"
                                }
                            }
                        ],
                        "opId": 33,
                        "opName": "MyriaApply(L_ORDERKEY=$0)",
                        "opType": "Apply"
                    },
                    {
                        "argChild": 33,
                        "distributeFunction": {
                            "indexes": [
                                0
                            ],
                            "type": "Hash"
                        },
                        "opId": 29,
                        "opName": "MyriaShuffleProducer(h($0))",
                        "opType": "ShuffleProducer"
                    }
                ]
            },
            {
                "operators": [
                    {
                        "debroadcast": false,
                        "opId": 34,
                        "opName": "MyriaScan(public:adhoc:ORDERS)",
                        "opType": "TableScan",
                        "relationKey": {
                            "programName": "adhoc",
                            "relationName": "ORDERS",
                            "userName": "public"
                        }
                    },
                    {
                        "argChild": 34,
                        "emitExpressions": [
                            {
                                "outputName": "O_ORDERKEY",
                                "rootExpressionOperator": {
                                    "columnIdx": 0,
                                    "type": "VARIABLE"
                                }
                            }
                        ],
                        "opId": 35,
                        "opName": "MyriaApply(O_ORDERKEY=$0)",
                        "opType": "Apply"
                    },
                    {
                        "argChild": 35,
                        "distributeFunction": {
                            "indexes": [
                                0
                            ],
                            "type": "Hash"
                        },
                        "opId": 27,
                        "opName": "MyriaShuffleProducer(h($0))",
                        "opType": "ShuffleProducer"
                    }
                ]
            }
        ],
        "type": "SubQuery"
    },
    "profilingMode": [],
    "rawQuery": "lineitem = scan('LINEITEM');\norders = scan('ORDERS');\n\n-- $ID$\n-- TPC-H/TPC-R Order Priority Checking Query (Q4)\n-- Functional Query Definition\n-- Approved February 1998\nexist = select\n    O_ORDERKEY as e_key,\n    COUNT(O_ORDERKEY) as e_count\n    from lineitem,\n         orders\n    where\n\t    L_ORDERKEY = O_ORDERKEY\n\t    and L_COMMITDATE < L_RECEIPTDATE;\n\nq4 = select\n    O_ORDERPRIORITY,\n\tcount(O_ORDERPRIORITY) as ORDER_COUNT\n    from\n        orders,\n        exist\n    where\n        e_key = O_ORDERKEY\n        and O_ORDERDATE >= ':1'\n        and O_ORDERDATE < '1993-10-01' -- ':1' + interval '3' month\n        and e_count > 0;\n\n--group by            -- not needed in myriaL\n--\to_orderpriority\n--order by\n--\to_orderpriority;\n\nstore(q4, q4);\n"
}