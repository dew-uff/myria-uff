{"ftMode": "NONE", "plan": {"fragments": [{"operators": [{"argOperatorId": 1, "opType": "LocalMultiwayConsumer", "opName": "MyriaSplitConsumer", "opId": 0}, {"opName": "MyriaApply(revenue=$0)", "opType": "Apply", "argChild": 0, "emitExpressions": [{"outputName": "revenue", "rootExpressionOperator": {"type": "VARIABLE", "columnIdx": 0}}], "opId": 2}, {"opType": "DbInsert", "opName": "MyriaStore(public:adhoc:q6)", "argOverwriteTable": true, "argChild": 2, "distributeFunction": {"type": "RoundRobin"}, "relationKey": {"userName": "public", "relationName": "q6", "programName": "adhoc"}, "opId": 3}]}, {"operators": [{"argOperatorId": 5, "opType": "CollectConsumer", "opName": "MyriaCollectConsumer", "opId": 4}, {"argGroupFields": [], "opType": "Aggregate", "opName": "MyriaGroupBy(; SUM($0))", "opId": 6, "argChild": 4, "aggregators": [{"type": "Primitive", "aggOps": ["SUM"], "column": 0}]}, {"opName": "MyriaSplitProducer", "opType": "LocalMultiwayProducer", "argChild": 6, "opId": 1}]}, {"operators": [{"debroadcast": false, "opType": "TableScan", "opName": "MyriaScan(public:adhoc:LINEITEM)", "relationKey": {"userName": "public", "relationName": "LINEITEM", "programName": "adhoc"}, "opId": 7}, {"opName": "MyriaSelect(((((($10 >= \"1994-01-01\") and ($10 < \"1995-01-01\")) and ($6 >= (0.06 - 0.01))) and ($6 <= (0.06 + 0.01))) and ($4 < 24)))", "opType": "Filter", "argChild": 7, "argPredicate": {"rootExpressionOperator": {"right": {"right": {"valueType": "LONG_TYPE", "type": "CONSTANT", "value": "24"}, "left": {"type": "VARIABLE", "columnIdx": 4}, "type": "LT"}, "left": {"right": {"right": {"right": {"valueType": "DOUBLE_TYPE", "type": "CONSTANT", "value": "0.01"}, "left": {"valueType": "DOUBLE_TYPE", "type": "CONSTANT", "value": "0.06"}, "type": "PLUS"}, "left": {"type": "VARIABLE", "columnIdx": 6}, "type": "LTEQ"}, "left": {"right": {"right": {"right": {"valueType": "DOUBLE_TYPE", "type": "CONSTANT", "value": "0.01"}, "left": {"valueType": "DOUBLE_TYPE", "type": "CONSTANT", "value": "0.06"}, "type": "MINUS"}, "left": {"type": "VARIABLE", "columnIdx": 6}, "type": "GTEQ"}, "left": {"right": {"right": {"valueType": "STRING_TYPE", "type": "CONSTANT", "value": "1995-01-01"}, "left": {"type": "VARIABLE", "columnIdx": 10}, "type": "LT"}, "left": {"right": {"valueType": "STRING_TYPE", "type": "CONSTANT", "value": "1994-01-01"}, "left": {"type": "VARIABLE", "columnIdx": 10}, "type": "GTEQ"}, "type": "AND"}, "type": "AND"}, "type": "AND"}, "type": "AND"}}, "opId": 8}, {"opName": "MyriaApply(_COLUMN0_=($5 * $6))", "opType": "Apply", "argChild": 8, "emitExpressions": [{"outputName": "_COLUMN0_", "rootExpressionOperator": {"right": {"type": "VARIABLE", "columnIdx": 6}, "left": {"type": "VARIABLE", "columnIdx": 5}, "type": "TIMES"}}], "opId": 9}, {"argGroupFields": [], "opType": "Aggregate", "opName": "MyriaGroupBy(; SUM($0))", "opId": 10, "argChild": 9, "aggregators": [{"type": "Primitive", "aggOps": ["SUM"], "column": 0}]}, {"opName": "MyriaCollectProducer(@None)", "opType": "CollectProducer", "argChild": 10, "opId": 5}]}], "type": "SubQuery"}, "rawQuery": "lineitem = scan('LINEITEM');\n\n-- $ID$\n-- TPC-H/TPC-R Forecasting Revenue Change Query (Q6)\n-- Functional Query Definition\n-- Approved February 1998\nq6 = select\n\tsum(L_EXTENDEDPRICE * L_DISCOUNT) as revenue\nfrom\n\tlineitem\nwhere\n\tL_SHIPDATE >=  \"1994-01-01\"\n\tand L_SHIPDATE < \"1995-01-01\"\n\tand L_DISCOUNT >= 0.06 - 0.01\n    and L_DISCOUNT <= 0.06 + 0.01\n\tand L_QUANTITY < 24;\n\nstore(q6, q6);", "profilingMode": [], "language": "myrial", "logicalRa": "Store(public:adhoc:q6)[Apply(revenue=$0)[GroupBy(; SUM($0))[Apply(_COLUMN0_=($5 * $6))[Select(((((($4 < 24) and ($6 <= (0.06 + 0.01))) and ($6 >= (0.06 - 0.01))) and ($10 < \"1995-01-01\")) and ($10 >= \"1994-01-01\")))[Scan(public:adhoc:LINEITEM)]]]]]"}
